a = [['Alanine', 'Alanine'], ['Algal Oil', 'Algal Oil'], ['Alpha-Lipoic Acid', 'Alpha-Lipoic Acid'], ['Anthocyanins', 'Anthocyanins'], ['Arginine', 'Arginine'], ['Aspartic Acid', 'Aspartic Acid'], ['Bacillus coagulans', 'Bacillus coagulans'], ['Beta-Carotene', 'Beta-Carotene'], ['Beta-Glucans', 'Beta-Glucans'], ['Bifidobacterium bifidum', 'Bifidobacterium bifidum'], ['Biotin (B7)', 'Biotin'], ['Boron', 'Boron'], ['Calcium', 'Calcium'], ['Carnitine', 'Carnitine'], ['Chlorella', 'Chlorella'], ['Chloride', 'Chloride'], ['Chlorophyll', 'Chlorophyll'], ['Choline', 'Choline'], ['Chromium', 'Chromium'], ['Cobalt', 'Cobalt'], ['Coenzyme Q10', 'Coenzyme Q10'], ['Collagen', 'Collagen'], ['Copper', 'Copper'], ['Curcumin', 'Curcumin'], ['Cysteine', 'Cysteine'], ['Dietary Fiber', 'Dietary Fiber'], ['EGCG (Epigallocatechin gallate)', 'EGCG'], ['Flavonoids', 'Flavonoids'], ['Fluoride', 'Fluoride'], ['Folate (B9)', 'Folate'], ['Glucosamine', 'Glucosamine'], ['Glutamic Acid', 'Glutamic Acid'], ['Glutamine', 'Glutamine'], ['Glycine', 'Glycine'], ['Histidine', 'Histidine'], ['Inositol', 'Inositol'], ['Inulin', 'Inulin'], ['Iodine', 'Iodine'], ['Iron', 'Iron'], ['Isoflavones', 'Isoflavones'], ['Isoleucine', 'Isoleucine'], ['Lactobacillus acidophilus', 'Lactobacillus acidophilus'], ['Leucine', 'Leucine'], ['Lutein', 'Lutein'], ['Lycopene', 'Lycopene'], ['Lysine', 'Lysine'], ['MCTs (Medium-chain triglycerides)', 'MCTs'], ['Magnesium', 'Magnesium'], ['Manganese', 'Manganese'], ['Methionine', 'Methionine'], ['Molybdenum', 'Molybdenum'], ['Niacin (B3)', 'Niacin'], ['Nickel', 'Nickel'], ['Omega-3 Fatty Acids (ALA, EPA, DHA)', 'Omega-3 Fatty Acids (Combined ALA, EPA, DHA)'], ['Omega-6 Fatty Acids (LA, GLA)', 'Omega-6 Fatty Acids (LA)'], ['PABA (Para-aminobenzoic acid)', 'PABA'], ['Pantothenic Acid (B5)', 'Pantothenic Acid'], ['Phenylalanine', 'Phenylalanine'], ['Phosphorus', 'Phosphorus'], ['Phytosterols', 'Phytosterols'], ['Polyphenols', 'Polyphenols'], ['Potassium', 'Potassium'], ['Proline', 'Proline'], ['Quercetin', 'Quercetin'], ['Resveratrol', 'Resveratrol'], ['Riboflavin (B2)', 'Riboflavin'], ['Saccharomyces boulardii', 'Saccharomyces boulardii'], ['Saponins', 'Saponins'], ['Selenium', 'Selenium'], ['Serine', 'Serine'], ['Silicon', 'Silicon'], ['Sodium', 'Sodium'], ['Spirulina', 'Spirulina'], ['Sulfur', 'Sulfur'], ['Tannins', 'Tannins'], ['Thiamin (B1)', 'Thiamin'], ['Threonine', 'Threonine'], ['Total Protein', 'Total Protein'], ['Tryptophan', 'Tryptophan'], ['Tyrosine', 'Tyrosine'], ['Valine', 'Valine'], ['Vanadium', 'Vanadium'], ['Vitamin A', 'Vitamin A'], ['Vitamin B12', 'Vitamin B12'], ['Vitamin B6', 'Vitamin B6'], ['Vitamin C', 'Vitamin C'], ['Vitamin D', 'Vitamin D'], ['Vitamin E', 'Vitamin E'], ['Vitamin K', 'Vitamin K'], ['Water', 'Water'], ['Zeaxanthin', 'Zeaxanthin'], ['Zinc', 'Zinc']]
b = [['Arginine', 'Arginine'], ['Beta-Carotene', 'Beta-Carotene'], ['Calcium', 'Calcium'], ['Choline', 'Choline'], ['Coenzyme Q10', 'Coenzyme Q10'], ['Curcumin', 'Curcumin'], ['Docosahexaenoic Acid (DHA)', 'Omega-3 Fatty Acids (ALA, EPA, DHA)'], ['Eicosapentaenoic Acid (EPA)', 'Omega-3 Fatty Acids (ALA, EPA, DHA)'], ['Folate (B9)', 'Folate (B9)'], ['Glutamine', 'Glutamine'], ['Glycine', 'Glycine'], ['Iron', 'Iron'], ['Lactobacillus acidophilus', 'Lactobacillus acidophilus'], ['Leucine', 'Leucine'], ['Lutein', 'Lutein'], ['Lycopene', 'Lycopene'], ['Lysine', 'Lysine'], ['Magnesium', 'Magnesium'], ['Quercetin', 'Quercetin'], ['Resveratrol', 'Resveratrol'], ['Selenium', 'Selenium'], ['Vitamin A', 'Vitamin A'], ['Vitamin B12', 'Vitamin B12'], ['Vitamin C', 'Vitamin C'], ['Vitamin D', 'Vitamin D'], ['Water', 'Water'], ['Zinc', 'Zinc']]
c = [['Arginine', 'Arginine'], ['Beta-Carotene', 'Beta-Carotene'], ['Calcium', 'Calcium'], ['Choline', 'Choline'], ['Coenzyme Q10', 'Coenzyme Q10'], ['Curcumin', 'Curcumin'], ['Docosahexaenoic Acid (DHA)', 'Omega-3 Fatty Acids (EPA+DHA)'], ['Eicosapentaenoic Acid (EPA)', 'Omega-3 Fatty Acids (EPA+DHA)'], ['Folate (B9)', 'Folate'], ['Glutamine', 'Glutamine'], ['Glycine', 'Glycine'], ['Iron', 'Iron'], ['Lactobacillus acidophilus', 'Lactobacillus acidophilus'], ['Leucine', 'Leucine'], ['Lutein', 'Lutein'], ['Lycopene', 'Lycopene'], ['Lysine', 'Lysine'], ['Magnesium', 'Magnesium'], ['Quercetin', 'Quercetin'], ['Resveratrol', 'Resveratrol'], ['Selenium', 'Selenium'], ['Vitamin A', 'Vitamin A'], ['Vitamin B12', 'Vitamin B12'], ['Vitamin C', 'Vitamin C'], ['Vitamin D', 'Vitamin D'], ['Water', 'Water'], ['Zinc', 'Zinc']]
d = {
    # Amino Acids
    "Alanine": "Alanine",
    "Arginine": "Arginine",
    "Aspartic Acid": "Aspartic Acid",
    "Cysteine": "Cysteine",
    "Glutamic Acid": "Glutamic Acid",
    "Glutamine": "Glutamine",
    "Glycine": "Glycine",
    "Histidine": "Histidine",
    "Leucine": "Leucine",
    "Lysine": "Lysine",
    "Methionine": "Methionine",
    "Phenylalanine": "Phenylalanine",
    "Proline": "Proline",
    "Serine": "Serine",
    "Threonine": "Threonine",
    "Tryptophan": "Tryptophan",
    "Tyrosine": "Tyrosine",
    "Valine": "Valine",
    "Taurine": "Taurine",

    # Vitamins
    "Vitamin A": "Vitamin A",
    "Vitamin C": "Vitamin C",
    "Vitamin D": "Vitamin D",
    "Vitamin E": "Vitamin E",
    "Vitamin K": "Vitamin K",
    "Thiamin (B1)": "Vitamin B1",
    "Thiamin": "Vitamin B1",
    "Riboflavin (B2)": "Vitamin B2",
    "Riboflavin": "Vitamin B2",
    "Niacin (B3)": "Vitamin B3",
    "Niacin": "Vitamin B3",
    "Pantothenic Acid (B5)": "Vitamin B5",
    "Pantothenic Acid": "Vitamin B5",
    "Vitamin B6": "Vitamin B6",
    "Biotin (B7)": "Vitamin B7",
    "Biotin": "Vitamin B7",
    "Folate (B9)": "Vitamin B9",
    "Folate": "Vitamin B9",
    "Vitamin B12": "Vitamin B12",

    # Minerals & Electrolytes
    "Calcium": "Calcium",
    "Iron": "Iron",
    "Magnesium": "Magnesium",
    "Phosphorus": "Phosphorus",
    "Potassium": "Potassium",
    "Sodium": "Sodium",
    "Zinc": "Zinc",
    "Copper": "Copper",
    "Manganese": "Manganese",
    "Selenium": "Selenium",
    "Chromium": "Chromium",
    "Molybdenum": "Molybdenum",
    "Iodine": "Iodine",
    "Fluoride": "Fluoride",
    "Chloride": "Chloride",
    "Sulfur": "Sulfur",
    "Boron": "Boron",
    "Silicon": "Silicon",
    "Vanadium": "Vanadium",
    "Nickel": "Nickel",
    "Cobalt": "Cobalt",

    # Fatty Acids & Lipids
    "Docosahexaenoic Acid (DHA)": "Docosahexaenoic Acid (DHA)",
    "Eicosapentaenoic Acid (EPA)": "Eicosapentaenoic Acid (EPA)",
    "Omega-3 Fatty Acids (ALA, EPA, DHA)": "Omega-3 Fatty Acids",
    "Omega-3 Fatty Acids (ALA)": "Omega-3 Fatty Acids",
    "Omega-3 Fatty Acids (Combined ALA, EPA, DHA)": "Omega-3 Fatty Acids",
    "Omega-3 Fatty Acids (EPA+DHA)": "Omega-3 Fatty Acids",
    "Omega-6 Fatty Acids (LA, GLA)": "Omega-6 Fatty Acids",
    "Omega-6 Fatty Acids (LA)": "Omega-6 Fatty Acids",
    "MCTs (Medium-chain triglycerides)": "MCTs",
    "MCTs": "MCTs",

    # Phytonutrients & Plant Compounds
    "Beta-Carotene": "Beta-Carotene",
    "Lutein": "Lutein",
    "Zeaxanthin": "Zeaxanthin",
    "Lycopene": "Lycopene",
    "Chlorophyll": "Chlorophyll",
    "Curcumin": "Curcumin",
    "Resveratrol": "Resveratrol",
    "Quercetin": "Quercetin",
    "EGCG (Epigallocatechin gallate)": "EGCG",
    "EGCG": "EGCG",
    "Anthocyanins": "Anthocyanins",
    "Flavonoids": "Flavonoids",
    "Polyphenols": "Polyphenols",
    "Isoflavones": "Isoflavones",
    "Saponins": "Saponins",
    "Tannins": "Tannins",
    "Phytosterols": "Phytosterols",
    "Beta-Glucans": "Beta-Glucans",
    "Inulin": "Inulin",

    # Probiotics & Microbial Supplements
    "Lactobacillus acidophilus": "Lactobacillus acidophilus",
    "Bifidobacterium bifidum": "Bifidobacterium bifidum",
    "Saccharomyces boulardii": "Saccharomyces boulardii",
    "Bacillus coagulans": "Bacillus coagulans",

    # Other Nutrients & Co-factors
    "Choline": "Choline",
    "Coenzyme Q10": "Coenzyme Q10",
    "Carnitine": "Carnitine",
    "Inositol": "Inositol",
    "PABA (Para-aminobenzoic acid)": "PABA",
    "PABA": "PABA",
    "Glucosamine": "Glucosamine",
    "Collagen": "Collagen",

    # Macronutrients & Miscellany
    "Total Protein": "Protein",
    "Dietary Fiber": "Dietary Fiber",
    "Water": "Water"
}

import re
import csv

data={}

def parsetimee(string):
  r = r'[\D]'
  if string == "Birth to 6 months" or string == "0<6 months":
    return (0, 6)
  elif string[-6:] == "months":
    return (int(re.split(r, string.split(" ")[0])[0]), int(re.split(r, string.split(" ")[0])[1]))
  elif string[-5:] == "years":
    if string.split(" ")[0][-1:] == "+":
      return (12*int(string.split(" ")[0][:-1]), 9999)
    else:
      return (12*int(re.split(r, string.split(" ")[0])[0]), 12*int(re.split(r, string.split(" ")[0])[1]))
  return "ERROR"

f = open("sources/comprehensive.csv")
f = csv.DictReader(f)

data["comprehensive"] = []
for nutrient in f:
  r = r'[\W^ ^)^(]'
  a = dict(nutrient=d[nutrient["Nutrient"]], age_months_start=parsetimee(nutrient["Age_Group"])[0], gender=nutrient["Gender"], amount=nutrient["Amount"], unit=nutrient["Unit"], source_type=nutrient["Source_Type"], source_name=nutrient["Source_Name"], source_url=nutrient["Source_URL"], nutrient_notes=nutrient["Nutrient_Notes"])
  if parsetimee(nutrient["Age_Group"])[1]:
    a["age_months_end"] = parsetimee(nutrient["Age_Group"])[1]
  data["comprehensive"].append(a)

f = open("sources/enhanced.csv")
f = csv.DictReader(f)

data["enhanced"] = []
for nutrient in f:
  r = r'[\W^ ^)^(]'
  if nutrient["Male"] == "CS" or nutrient["Male"] == "ND":
    continue
  for col in ["Male", "Female", "Pregnant", "Lactating"]:
    if not nutrient[col]:
      continue
    a=dict(nutrient=d[nutrient["Nutrient"]], age_months_start=parsetimee(nutrient["Age_Group"])[0], gender=col, amount=nutrient[col], unit=nutrient["Unit"], source_type=nutrient["Source"], source_name=nutrient["Source_Links"], nutrient_notes=nutrient["Footnotes"] + ". " +nutrient["Nutrient_Notes"])
    if parsetimee(nutrient["Age_Group"])[1]:
      a["age_months_end"]=parsetimee(nutrient["Age_Group"])[1]
    data["enhanced"].append(a)

f = open("sources/complete.csv")
f = csv.DictReader(f)

data["complete"] = []
for nutrient in f:
  r = r'[\W^ ^)^(]'
  if nutrient["male"] == "CS" or nutrient["male"] == "ND":
    continue
  for col in ["male", "female", "pregnant", "lactating"]:
    if not nutrient[col]:
      continue
    a=dict(nutrient=d[nutrient["nutrient"]], age_months_start=parsetimee(nutrient["age"])[0], gender=col.capitalize(), amount=nutrient[col], unit=nutrient["footnotes"].split(" - ")[1], source_type="Optimal Diet Analysis", source_name="Calculated from optimal diet pattern analysis", nutrient_notes="No good sources for amount required")
    if parsetimee(nutrient["age"])[1]:
      a["age_months_end"]=parsetimee(nutrient["age"])[1]
    data["complete"].append(a)



# Example usage
if __name__ == "__main__":
    da = {}